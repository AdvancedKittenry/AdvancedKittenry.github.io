<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <title>Tietokannan suunnittelu</title>
  <style type="text/css">code{white-space: pre;}</style>
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link rel="stylesheet" href="../../css/base.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
  <script src="http://advancedkittenry.github.io/javascript/bootstrap.js"></script>
  <script src="http://advancedkittenry.github.io/javascript/jquery.treeview.js"></script>
  <script src="http://advancedkittenry.github.io/javascript/jquery.scrollTo.js"></script>
  <script src="http://advancedkittenry.github.io/javascript/jquery.nav.js"></script>
  <script src="http://advancedkittenry.github.io/javascript/navi.js"></script>
</head>
<body>
<div class="titlebar">
  <div class="container">
    <div class="row">
      <h1 class="col-md-6 col-md-offset-3">Advanced Kittenry - Tietokantasovellusohjeet</h1>
    </div>
  </div>
</div>
<div class="container">
<div class="row">
<div class="navcontainer col-md-3">
<nav>
<ul>
<li><a href="../../index.html">Tietokantasovellus</a>
<ul>
<li><a href="../../aikataulu/index.html">Aikataulu</a>
<ul>
<li><a href="../../aikataulu/viikko1/index.html">Viikko 1</a>
<ul>
<li><a href="../../aikataulu/viikko1/aiheet/index.html">Aiheet</a>
<ul>
<li><a href="../../aikataulu/viikko1/aiheet/Drinkkiarkisto.html">Drinkkiarkisto</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Elektroninen_keittokirja.html">Elektroninen keittokirja</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Graduaiheet.html">Graduaiheet</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Harjoitustyon_seuranta.html">Harjoitustyön seuranta</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Hiihtokisojen_tulospalvelu.html">Hiihtokisojen tulospalvelu</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Huutokauppa.html">Huutokauppa</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Kennelkerho.html">Kennelkerho</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Kuluttajan_tuki_Ry.html">Kuluttajan tuki Ry</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Kurssikysely.html">Kurssikysely</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Kurssin_kotisivu.html">Kurssin kotisivu</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Kurssitarjonta_ja_kurssipaikan_varaus.html">Kurssitarjonta ja kurssipaikan varaus</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Lainahakemusten_kasittely.html">Lainahakemusten käsittely</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Laakariaseman_tyovuorolista.html">Lääkäriaseman työvuorolista</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Laakarin_kotikaynnit.html">Lääkärin kotikäynnit</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Matkojen_markkinointi.html">Matkojen markkinointi</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Muistilista.html">Muistilista</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Ostoskassi.html">Ostoskassi</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Painontarkkailu.html">Painontarkkailu</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Palvelubisnes.html">Palvelubisnes</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Parturi-Kampaamo.html">Parturi-Kampaamo</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Pizzapalvelu.html">Pizzapalvelu</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Projektin_tyoaikaseuranta.html">Projektin työaikaseuranta</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Rankkauslista.html">Rankkauslista</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Taloyhtion_palvelut.html">Taloyhtiön palvelut</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Tavaranvaihto.html">Tavaranvaihto</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Tukkuliikkeen_tilaustenksittely.html">Tukkuliikkeen tilaustenkäsittely</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Tutkimusaineston_kerays.html">Tutkimusaineiston keräys</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Tyoaihekanta.html">Työaihekanta</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Tyontekijanvuokraus_kotitoihin.html">Työntekijänvuokraus kotitöihin</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Tyryhmtiedotus.html">Työryhmätiedotus</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Opintoneuvonnan_usein_kysytyt_kysymykset.html">Usein kysytyt kysymykset</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Vedonlyonti.html">Vedonlyönti</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Vuokra-asuntojen_valitys.html">Vuokra-asuntojen välitys</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Ystavanvalityspalvelu.html">Ystävänvälityspalvelu</a></li>
<li><a href="../../aikataulu/viikko1/aiheet/Aanestys.html">Äänestys</a></li>
</ul></li>
<li><a href="../../aikataulu/viikko1/ohjelmointikielet.html">Ohjelmointikielen valinta</a></li>
<li><a href="../../aikataulu/viikko1/tietokannat.html">Tietokannan valinta</a></li>
<li><a href="../../aikataulu/viikko1/dokumentointi.html">Dokumentaation aloittaminen</a></li>
<li><a href="../../aikataulu/viikko1/git-ohje.html">Versionhallinta</a></li>
</ul></li>
<li><a href="../../aikataulu/viikko2/index.html">Viikko 2</a>
<ul>
<li><a href="../../aikataulu/viikko2/tekniikka.html">Tietokantojen ja palvelimien käyttöönotto</a></li>
<li><a href="../../aikataulu/viikko2/suunnittelu.html">Käyttöliittymän suunnittelu</a></li>
<li class="selected"><a href="../../aikataulu/viikko2/tietokanta.html">Tietokannan suunnittelu</a></li>
<li><a href="../../aikataulu/viikko2/netbeans.html">NetBeansin käyttöönotto</a></li>
<li><a href="../../aikataulu/viikko2/html-versioiden-luonti.html">HTML-versioiden luominen</a></li>
</ul></li>
<li><a href="../../aikataulu/viikko3/index.html">Viikko 3</a>
<ul>
<li><a href="../../aikataulu/viikko3/arkkitehtuuri.html">Arkkitehtuuriohje</a></li>
<li><a href="../../aikataulu/viikko3/java/index.html">Kirjautuminen Javalla</a>
<ul>
<li><a href="../../aikataulu/viikko3/java/rakenne.html">Sovelluksen rakenne ja servletit</a></li>
<li><a href="../../aikataulu/viikko3/java/lomakkeet.html">Lomakkeiden käyttö ja vastaanottaminen</a></li>
<li><a href="../../aikataulu/viikko3/java/istunnot.html">Istunnot ja kirjautumisen tallentaminen</a></li>
</ul></li>
<li><a href="../../aikataulu/viikko3/php/index.html">Kirjautuminen PHP:llä</a>
<ul>
<li><a href="../../aikataulu/viikko3/php/rakenne.html">Mihin eri tiedostot kannattaa laittaa?</a></li>
<li><a href="../../aikataulu/viikko3/php/lomakkeet.html">Lomakkeiden käyttö ja vastaanottaminen</a></li>
<li><a href="../../aikataulu/viikko3/php/istunnot.html">Istunnot ja kirjautumisen tallentaminen</a></li>
</ul></li>
</ul></li>
<li><a href="../../aikataulu/viikko4/index.html">Viikko 4</a>
<ul>
<li><a href="../../aikataulu/viikko4/tietokantayhteys.html">Tietokantayhteyden pystytys</a></li>
<li><a href="../../aikataulu/viikko4/ssh-tunnelit.html">SSH-tunnelointi</a></li>
<li><a href="../../aikataulu/viikko4/mallit.html">Mallit ja tietokanta</a></li>
<li><a href="../../aikataulu/viikko4/nakymat.html">Tietokohteen sivujen toteuttaminen</a></li>
</ul></li>
<li><a href="../../aikataulu/demo.html">Demotilaisuus</a></li>
<li><a href="../../aikataulu/palautus.html">Työn palautus</a></li>
</ul></li>
<li><a href="../../arvosteluperusteet.html">Arvosteluperusteet</a></li>
<li><a href="../../dokumentaatio-ohje.html">Dokumentaatio-ohje</a></li>
<li><a href="../../cleancode.html">Hyvä ohjelmointityyli</a></li>
<li><a href="../../kaytettavyys.html">Käytettävyys</a></li>
<li><a href="../../web-sovelluksista.html">Web-sovelluksien toiminta</a></li>
</ul></li>
</ul>
</nav>
</div>
<div class="col-md-6" id="content">
<header>
<h1 class="title">Tietokannan suunnittelu</h1>
</header>
<!-- order: 3 -->

<section class="alert alert-info"><h3>
Tiivistelmä:
</h3>
<ul>
<li>Suunnittele tietokantasi</li>
<li><a href="#tietokannan-alustustiedostojen-luominen">Luo tiedostot tietokannan taulujen luomiseen ja alasajoon</a>
<ul>
<li><code>sql/create-tables.sql</code></li>
<li><code>sql/drop-tables.sql</code></li>
<li><code>sql/add-test-data.sql</code></li>
</ul></li>
</ul>
</section>

<p>Suunniteltuasi sovelluksen ulkoasua, uppoa tietokantataulujen maailmaan. Tee sovelluksellesi alustava käsitekaavio erittelemällä tekemiltäsi sivuilta ja aihekuvauksesta kaikki tietokohteet sekä niiden väliset riippuvuudet yhdellä kaaviolla:</p>
<figure>
<img src="../../images/aikataulu/viikko2/kasitekaavio.jpg" alt="Esimerkki alustavasta käsitekaaviosta" /><figcaption>Esimerkki alustavasta käsitekaaviosta</figcaption>
</figure>
Tässäkin voi olla vielä järkevää käyttää paperia tai valkotaulua, mutta jossuunnitelma on päässäsi jo selkeä, voit käyttää suoraan kaavio-ohjelmistoa, jolloin jälki on siistimpää.
<button type='button' class='btn-link expandable collapsed' data-toggle='collapse' data-target='#expandable_1'>
Siistimpi käsitekaavioversio (avaa tästä)
</button>
  <div id='expandable_1' class='collapse'><section>

<figure>
<img src="../../images/dokumentaatio-ohje/information_diagram.png" alt="Esimerkki käsitekaaviosta" /><figcaption>Esimerkki käsitekaaviosta</figcaption>
</figure>
</section></div>

<p>Kaikki tähän alustavaan käsitekaavioon tulevat asiat eivät välttämättä ole relevantteja ohjelman toteutuksen kannalta. Esimerkiksi palveluskunta ei kokonaisuutena näyttele juuri mitään roolia ohjelman toiminnassa, vaan pääosassa ovat sen jäsenet. Lopullisessa kissalistan toteutuksessa ei tämän takia ole palveluskunta-taulua. Hyvänä valintakriteerinä on se, sisältääkö tietokohde jotain omia kenttiään, vai onko se vain täysin osasistaan koostuva kokoelma.</p>
<p>Lähde tämän jälkeen tekemään listaa kunkin kaavion tietokohteen sisältämistä tietokentistä, niiden tyypeistä ja rooleista sovelluksessa. Liitä kenttien kuvaukset taulukkoina dokumentaatioon. Myös yhteydet toisiin kohteisiin täytyy määritellä. Lopputuloksen kuuluu näyttää tämäntapaiselta:</p>
<blockquote>
<p><strong>Tietokohde: Kissa</strong></p>
<table class="table table-striped table-bordered">
<col style="width: 26%" /><col style="width: 25%" /><col style="width: 37%" /><thead>
<tr class="header">
<th style="text-align: left;">Attribuutti</th>
<th style="text-align: left;">Arvojoukko</th>
<th style="text-align: left;">Kuvailu</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Nimi</td>
<td style="text-align: left;">Merkkijono, max. 80 merkkiä</td>
<td style="text-align: left;">Kissan nimi</td>
</tr>
<tr class="even">
<td style="text-align: left;">Väri</td>
<td style="text-align: left;">Merkkijono, max. 30 merkkiä</td>
<td style="text-align: left;">Kuvaus kissan väristä esim. “valkotäplikäs oranssi”</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kuva</td>
<td style="text-align: left;">Kuvatiedosto, vapaaehtoinen</td>
<td style="text-align: left;">Kuva kissasta</td>
</tr>
<tr class="even">
<td style="text-align: left;">Viim. ruokkimis-pvm.</td>
<td style="text-align: left;">Päivämäärä</td>
<td style="text-align: left;">Koska kissa on viimeksi ruokittu?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lisätiedot</td>
<td style="text-align: left;">Merkkijono, max. 255 merkkiä</td>
<td style="text-align: left;">Kuvaus kissan ominaisuuksista esim. “Serafiina syö vain kalaa.”</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lainaajan nimi</td>
<td style="text-align: left;">Merkkijono, max. 40 merkkiä, vapaaehtoinen</td>
<td style="text-align: left;">Mahdollisen kissan lainaajan nimi</td>
</tr>
</tbody>
</table>
<p>Kissa, joka asuu kissatädin kartanossa. Jokainen kissa kuuluu tasan yhteen kissarotuun. Jokaisesta kissasta merkitään ylös sitä viimeksi ruokkinut palvelija.</p>
</blockquote>
<section id="relaatiotietokantakaavio" class="level2">
<h2>Relaatiotietokantakaavio</h2>
<p>Tee nyt suunnittelemastasi tietosisällöstä <a href="../../dokumentaatio-ohje.html#relaatiotietokantakaavio">dokumentaatio-ohjeen mukainen relaatiotietokantakaavio</a>: <img src="../../images/dokumentaatio-ohje/relaatiokaavio.gif" alt="Kissoihin liittymätön relaatiotietokantakaavio" /></p>
<p>Muista lisätä kaavioon kaikki olennaiset viiteavaimet sekä monesta-moneen suhteiden tilalle välitaulut.</p>
<p>Tallenna tekemäsi kaaviot ja uusi sisältö repositoriosi dokumentaatiotiedostoon. Lisää myös kaavioiden tuottamiseen käyttämäsi lähdetiedostot repositoriosi doc-kansioon niin ne pysyvät tallessa muutosten varalta.</p>
</section>
<section id="tietokannan-alustustiedostojen-luominen" class="level2">
<h2>Tietokannan alustustiedostojen luominen</h2>
<p>Muistele Tietokantojen perusteet -kurssilla oppimaasi SQL-kieltä ja tutustu valitsemasi tietokannan dokumentaatioon. Luo sitten repositorioosi sql-kansio ja sijoita siihen kolme sql-tiedostoa: <code>create-tables.sql</code>, <code>drop-tables.sql</code> ja <code>add-test-data.sql</code>. Kirjoita näihin tiedostoihin tietokantasi alustavat create table -lauseet, drop table -lauseet, ja testidatan (oletuskäyttäjätunnusten yms.) luominen.</p>
<p>SQL-lauseiden sijoittaminen tiedostoihin mahdollistaa kannan helpon pystyttämisen ja alasajon. Voit ajaa sql-tiedostoon kantaan kirjautumalla usersille ja käyttämällä unixin <em>putkitusta</em>. Esimeriksi PostgreSQL:llä tämä tapahtuu seuraavasti:</p>
<pre><code>psql &lt; sql/create-tables.sql</code></pre>
<p>Yllä oleva komento suorittaa tiedoston sisältämät SQL-lauseet tietokannassa. MySQL-versio on samantapainen, mutta komentona on psql:n sijasta mysql, minkä lisäksi mysql kysyy sinulta salasanaa.</p>
<p>Mikäli haluaa resetoida koko tietokantansa voi ajaa seuraavat kolme komentoa peräkkäin:</p>
<pre><code>psql &lt; sql/drop-tables.sql
psql &lt; sql/create-tables.sql
psql &lt; sql/add-test-data.sql</code></pre>
<p>Tiedostossa <code>drop-tables.sql</code> kannattaa käyttää pudotuskäskystä muotoa <code>DROP TABLE IF EXISTS taulun_nimi</code>. Näin tietokantataulun puuttuminen ei katkaise komentosarjaa. Viiteavaimien takia joudut myös yleensä kirjoittamaan pudotuskäskyt päinvastaisessa järjestyksessä luontilauseisiin nähden. Muuten viite-eheystarkistukset eivät välttämättä anna ajaa kantaa alas.</p>
<section class="alert alert-success small"><h3>
Seuraavaksi:
</h3>
<p>Suunniteltuasi kaiken tee suunnitelmistasi demoversiot <a href="html-versioiden-luonti.html">HTML:llä ja CSS:llä</a>.</p>
</section>




</section>
</div>
</div> 
</div> 
<footer>
  <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">AdvancedKittenry</span> 
  by
  <a xmlns:cc="http://creativecommons.org/ns#" href="http://advancedkittenry.github.io/credits.html" property="cc:attributionName" rel="cc:attributionURL">David Consuegra and others</a>
  is licensed under a 
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">
    <img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/80x15.png" />
  </a>
</footer>
</body>
</html>
